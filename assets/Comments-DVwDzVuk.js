const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/profile-img-Cny2AAw6.js","assets/index-2rX3LEy2.js","assets/index-Dnrht0vh.css"])))=>i.map(i=>d[i]);
import{u as f,j as e,N as b,r,b as j,_ as v}from"./index-2rX3LEy2.js";import{q as N,c as y,w,d as i,e as C,a as _,f as E,g as c,s as P}from"./firebase-DJJ2nZbU.js";import{f as S}from"./index-DRhNWrBV.js";const L="/ruche-journal/signin-google.png",m=r.lazy(()=>v(()=>import("./profile-img-Cny2AAw6.js"),__vite__mapDeps([0,1,2])));function I({article_id:o}){const{slug:d}=f();if(!d)return e.jsx(b,{to:"/"});const[u,x]=r.useState([]),a=j(s=>s.user.value),[t,n]=r.useState(""),g=async()=>{if(t.trim())try{await E(i(c,"comments"),{article_id:o,name:a.displayName,avatar:a.photoURL,date:P(),text:t}),n("")}catch(s){console.error("Error adding comment: ",s)}};return r.useEffect(()=>{const s=N(i(c,"comments"),w("article_id","==",o),y("date","desc")),h=C(s,p=>{x(p.docs.map(l=>({id:l.id,...l.data()})))});return()=>h()},[]),e.jsxs("div",{className:"mt-10 border-t pt-8 border-gray-300",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Commentaires"}),a?e.jsxs("div",{className:"flex items-start gap-3 mb-8",children:[e.jsx(m,{src:a.photoURL,alt:"User avatar",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{className:"w-full p-3 border rounded-lg focus:outline-none focus:ring focus:ring-blue-300",placeholder:"Écrire un commentaire...",value:t,onChange:s=>n(s.target.value)}),e.jsx("button",{onClick:g,type:"submit",className:"px-8 py-3 bg-gray-100 text-gray-900 rounded-lg font-semibold hover:bg-gray-300 transition-colors hover:cursor-pointer shadow-md",children:"Publier"})]})]}):e.jsxs("div",{className:"px-4 p-2 mb-8 border rounded-lg bg-gray-50 flex gap-4 items-center justify-between text-center",children:[e.jsx("p",{className:"text-gray-700 font-medium",children:e.jsx("small",{children:"Vous devez être connecté pour publier un commentaire."})}),e.jsx("button",{className:"p-2 rounded cursor-pointer border border-gray-300 hover:bg-gray-100 transition-all",onClick:_,children:e.jsx("img",{src:L,width:30,height:30})})]}),e.jsx("div",{className:"space-y-6",children:u.map(s=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx(m,{src:s.avatar,alt:"avatar",className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold",children:s.name}),e.jsx("span",{className:"text-sm text-gray-400",children:S(s.date?.seconds)})]}),e.jsx("p",{className:"mt-1 text-gray-700",children:s.text})]})]},s.id))})]})}export{I as default};
