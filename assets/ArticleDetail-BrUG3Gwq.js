import{c as g,u as p,r as l,j as e,L as u,N as w,b as k,q as C,o as _,w as S,d as f,e as A,h as $,f as L,g as j,s as R,F as U,T as E,i as q}from"./index-D0W1Llbe.js";import{s as b,a as I,L as y,f as N,b as P,U as T,C as z}from"./Loading-C6Z-4G4g.js";const D=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],F=g("arrow-left",D);const B=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],G=g("check",B);const H=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],M=g("circle-x",H);const V=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],v=g("share-2",V);function W({category_id:t,count:s}){const{slug:n}=p(),[o,i]=l.useState([]),[d,r]=l.useState(!0);l.useEffect(()=>{n&&x()},[n]);const x=async()=>{try{r(!0),await b(5e3);const a=await I(t,s);i(a||null)}catch(a){console.error("Error fetching article:",a)}finally{r(!1)}};if(d)return e.jsx(y,{});if(o.length)return e.jsxs("section",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Related Articles"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:o.map(a=>e.jsxs(u,{to:`/article/${a.slug}`,className:"group block bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[e.jsx("div",{className:"aspect-[16/9] overflow-hidden",children:e.jsx("img",{src:a.cover_image_url,alt:a.title,className:"w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-500"})}),e.jsx("div",{className:"p-6",children:e.jsx("h3",{className:"text-lg font-bold text-gray-900 line-clamp-2 group-hover:text-gray-700 transition-colors",children:a.title})})]},a.id))})]})}const X="/ruche-journal/signin-google.png";function J({article_id:t}){const{slug:s}=p();if(!s)return e.jsx(w,{to:"/"});const[n,o]=l.useState([]),i=k(a=>a.user.value),[d,r]=l.useState(""),x=async()=>{if(d.trim())try{await L(f(j,"comments"),{article_id:t,name:i.displayName,avatar:i.photoURL,date:R(),text:d}),r("")}catch(a){console.error("Error adding comment: ",a)}};return l.useEffect(()=>{const a=C(f(j,"comments"),S("article_id","==",t),_("date","desc")),m=A(a,c=>{o(c.docs.map(h=>({id:h.id,...h.data()})))});return()=>m()},[]),e.jsxs("div",{className:"mt-10 border-t pt-8 border-gray-300",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Comments"}),i?e.jsxs("div",{className:"flex items-start gap-3 mb-8",children:[e.jsx("img",{src:i.photoURL,alt:"User avatar",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{className:"w-full p-3 border rounded-lg focus:outline-none focus:ring focus:ring-blue-300",placeholder:"Write a comment...",value:d,onChange:a=>r(a.target.value)}),e.jsx("button",{onClick:x,type:"submit",className:"px-8 py-3 bg-gray-100 text-gray-900 rounded-lg font-semibold hover:bg-gray-300 transition-colors hover:cursor-pointer shadow-md",children:"Post Comment"})]})]}):e.jsxs("div",{className:"px-4 p-2 mb-8 border rounded-lg bg-gray-50 flex gap-4 items-center justify-between text-center",children:[e.jsx("p",{className:"text-gray-700 font-medium",children:e.jsx("small",{children:"Vous devez être connecté pour publier un commentaire."})}),e.jsx("button",{className:"p-2 rounded cursor-pointer border border-gray-300 hover:bg-gray-100 transition-all",onClick:$,children:e.jsx("img",{src:X,width:30,height:30})})]}),e.jsx("div",{className:"space-y-6",children:n.map(a=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:a.avatar,alt:"avatar",className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold",children:a.name}),e.jsx("span",{className:"text-sm text-gray-400",children:N(a.date?.seconds)})]}),e.jsx("p",{className:"mt-1 text-gray-700",children:a.text})]})]},a.id))})]})}function K({author:t}){if(t)return e.jsx("div",{className:"bg-gray-50 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-16 h-16 rounded-full"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:t.name}),e.jsx("p",{className:"text-gray-600",children:t.bio})]})]})})}const Q=[{icon:U,link:(t,s)=>`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`},{icon:E,link:(t,s)=>`https://twitter.com/intent/tweet?url=${encodeURIComponent(t)}&text=${encodeURIComponent(s)}`},{icon:q,link:(t,s)=>`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(t)}`}];function Y({title:t,active:s,onClose:n,onOpen:o}){if(!s)return null;const[i,d]=l.useState(!1),r={title:t||"Check this out!",url:window.location.href},x=()=>{d(!0),navigator.clipboard.writeText(r.url),setTimeout(()=>{d(!1)},2e3)};o&&o();const a=async()=>{if(navigator.share)try{await navigator.share(r),n&&n()}catch(m){console.error("Share failed:",m)}};return e.jsx("div",{className:"share-popup-overlay",onClick:n,children:e.jsxs("div",{className:"share-popup max-w-sm",onClick:m=>m.stopPropagation(),children:[e.jsx("h3",{className:"mb-4",children:"Partager"}),"share"in navigator&&e.jsxs("button",{className:"flex justify-center gap-8 bg-gray-200 p-3 rounded mb-6 cursor-pointer w-full shadow-lg hover:shadow-xl transition-all",onClick:a,children:[e.jsx(v,{className:"hover:scale-125 transition-all"}),e.jsx("span",{children:"Partager via l'appareil…"})]}),e.jsx("div",{className:"share-options mb-6 flex justify-center gap-16",children:Q.map(({link:m,icon:c},h)=>e.jsx("a",{href:m(r.url,t),target:"_blank",rel:"noopener noreferrer",className:"rounded-full bg-gray-200 p-4 shadow-lg hover:shadow-xl transition-all",children:e.jsx(c,{className:"hover:scale-125 transition-all",fill:"black"})},"share"+h))}),e.jsxs("button",{className:"flex mb-4 cursor-pointer items-center justify-center bg-gray-200 rounded",onClick:x,children:[e.jsx("small",{className:"p-2 mr-2",children:"Copie"}),e.jsxs("small",{className:"pl-3 border-s border-gray-500 flex pt-1 text-sm whitespace-nowrap overflow-x-hidden w-full",children:[`${r.url.slice(0,35)}...    `,e.jsx(G,{className:i?"text-green-500":"text-gray-200"})]})]}),e.jsx("br",{}),e.jsx("button",{className:"cursor-pointer",onClick:n,children:e.jsx(M,{className:"text-red-800 hover:scale-125 transition-all"})})]})})}function ee(){const{slug:t}=p(),[s,n]=l.useState(null),[o,i]=l.useState([]),[d,r]=l.useState(!0),[x,a]=l.useState(!1);l.useEffect(()=>{t&&m()},[t]);const m=async()=>{try{r(!0),await b(500);const c=await P(t);n(c||null),i(c?.tags??[])}catch(c){console.error("Error fetching article:",c)}finally{r(!1)}};return d?e.jsx(y,{}):s?e.jsxs("article",{className:"min-h-screen bg-white mb-16",children:[e.jsxs("div",{className:"relative h-[60vh] overflow-hidden",children:[e.jsx("img",{src:s.cover_image_url,alt:s.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"})]}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 -mt-32 relative z-10",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 md:p-12",children:[e.jsxs("div",{className:"flex justify-between flex-wrap mb-4",children:[e.jsxs(u,{to:"/",className:"inline-flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{children:"Back"})]}),s.category&&e.jsx(u,{to:`${window.location.origin}/category/${s.category.slug}`,children:e.jsx("span",{className:"inline-block px-4 py-1.5 rounded-full text-sm font-semibold shadow-md hover:shadow-lg transition-all cursor-pointer",style:{backgroundColor:`${s.category.color}15`,color:s.category.color},children:s.category.name})})]}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-6 leading-tight",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6 mb-8 pb-8 border-b border-gray-200",children:[s.author&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.author.avatar_url,alt:s.author.name,className:"w-12 h-12 rounded-full"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-900 font-semibold",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{children:s.author.name})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-500 text-sm",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:N(s.published_at)})]})]})]}),e.jsxs("button",{className:"cursor-pointer ml-auto flex items-center space-x-2 px-4 py-2 border border-gray-300 hover:bg-gray-50 transition-colors rounded-full","aria-label":"Share article",onClick:()=>a(!0),children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Share"})]}),e.jsx(Y,{active:x,onClose:()=>{a(!1)},title:s.title})]}),e.jsxs("div",{className:"prose prose-lg max-w-none mb-8",children:[e.jsx("p",{className:"text-xl text-gray-700 leading-relaxed mb-6",children:s.excerpt}),e.jsx("div",{className:"text-gray-800 leading-relaxed whitespace-pre-line",children:s.content})]}),o.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-8 pb-8 border-b border-gray-200",children:o.map(c=>e.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200 transition-colors cursor-pointer",children:["#",c.name]},c.id))}),e.jsx(K,{author:s.author}),e.jsx(J,{article_id:s.id})]})}),s?.category?.id&&e.jsx(W,{category_id:s?.category?.id,count:7})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Article Not Found"}),e.jsx(u,{to:"/",className:"text-blue-600 hover:text-blue-700",children:"Return to Home"})]})})}export{ee as default};
